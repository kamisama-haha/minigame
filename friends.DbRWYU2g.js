import{d as H,p as R,o as i,a as l,k as c,C as ne,b as t,_ as A,u as y,i as Y,r as I,Z as j,e,t as $,$ as m,a0 as te,a1 as oe,V as re,J as ie,a2 as le,q as J,s as ae,w as C,F as U,D as Z,y as ce,j as de,c as N,m as w,a3 as ue,z as E,B as v,l as _e,a4 as q,W as K,a5 as W,a6 as fe,a7 as me,a8 as pe}from"./entry.Dv1IsjD4.js";import{_ as Q}from"./Preloader.vue.EL_BqhER.js";import{_ as B}from"./Price.vue.Cny252bW.js";const he=H({__name:"Copy",props:{text:{type:String,required:!0},iconSize:{type:String,required:!1,default:"is-32"}},setup(r){const n=R();return(u,o)=>{const f=A;return i(),l("button",{class:"button button-copy",onClick:o[0]||(o[0]=_=>t(n).copyText(r.text))},[c(f,{name:"copy",class:ne(r.iconSize)},null,8,["class"])])}}}),ve={class:"user-info"},$e={class:"user-info-avatar"},Te=["src"],be={class:"user-info-content"},ge={class:"user-info-content-data"},ye=e("span",{class:"is-circle"},null,-1),Ie={class:"text-grey"},Le=H({__name:"Telegram",props:{user:{}},setup(r){const n=r,u=y();Y();const o=I(n.user.avatarUrl??"");o.value||(o.value=j);function f(){o.value=j}const _=d=>Object.keys(m)[Object.values(m).indexOf(d??1)];return(d,g)=>{const T=B;return i(),l("div",ve,[e("div",$e,[e("img",{src:t(o),onError:f},null,40,Te)]),e("div",be,[e("p",null,$(t(u).composeTelegramName({firstName:d.user.firstName,lastName:d.user.lastName})),1),e("div",ge,[e("span",null,$(_(d.user.level??1)),1),ye,c(T,{price:d.user.earnPassivePerHour,round:!0,size:"super-small"},null,8,["price"]),e("span",Ie,"聽聽("+$(t(u).numberFormat(d.user.balanceCoins))+")",1)])])])}}}),Me=te("referral",{state:()=>({users:[],count:0,offset:0,refresh_interval:null,refresh_time:0,loaded:!1}),actions:{async postReferralStat(r=0){return await oe.post("/clicker/referral-stat",{body:{offset:r}})},startRefreshInterval(){this.refresh_time=re.REFERRAL_REFRESH_TIME,this.refresh_interval=ie(()=>{this.refresh_time-=1,this.refresh_time<=0&&this.clearRefreshInterval()},1e3)},clearRefreshInterval(){this.refresh_interval!==null&&(clearInterval(this.refresh_interval),this.refresh_interval=null)},setUsers(r=[]){this.users=[]},addUsers(r=[]){this.users.push(...r)},setCount(r){this.count=r},setOffset(r){this.offset=r},setLoaded(r){this.loaded=r},addOffset(r){this.offset+=r}}}),Ce={class:"friends-wrap"},Ee={class:"section-title"},He=["disabled"],ke={key:0},Se={key:0,class:"friends-list"},Ne={class:"friends-item-user"},we={class:"friends-item-stats"},Re={key:1,class:"friends-progress"},Ue={key:2,class:"friends-no"},Ae={key:0,class:"friends-no-error"},Be={class:"friends-no-icon"},Ve=e("p",null,"Don't worry, friends haven't gone anywhere!",-1),Pe=e("p",null,"We've temporarily hidden the list to perform technical maintenance.",-1),Oe=e("p",null,"Thank you for being with us!",-1),Fe=e("p",{class:"is-bold"},"The list of your friends will return soon!",-1),ze=["innerHTML"],De=H({__name:"List",setup(r){const n=Me(),u=y(),o=I(!0),f=le(),_=I(!1);function d(){o.value=!0,n.postReferralStat(n.offset).then(a=>{a.stats.length&&(n.addUsers(a.stats),n.addOffset(a.stats.length)),a.count&&(n.setCount(a.count),_.value=!1),a.stats.length===0&&(n.setOffset(n.count),_.value=!1)}).catch(a=>{u.showErrorPush(),_.value=!0}).finally(()=>{o.value=!1,n.setLoaded(!0)})}J(()=>{n.loaded?o.value=!1:d(),document.addEventListener("scroll",g)}),ae(()=>{document.removeEventListener("scroll",g)});const g=()=>{const a=window.innerHeight,L=window.pageYOffset||document.documentElement.scrollTop,s=document.body.scrollHeight;a+L+30>=s&&n.offset<n.count&&!o.value&&d()},T=()=>{n.refresh_interval||(n.startRefreshInterval(),n.setCount(0),n.setOffset(0),n.setUsers([]),d(),f.postUpgradesForBuy())};return(a,L)=>{const s=A,p=Le,k=B,S=Q;return i(),l("div",Ce,[e("div",Ee,[e("span",null,$(a.$t("friends.friends_list"))+" "+$(t(n).count>0?`(${t(n).count})`:""),1),e("button",{class:"button",onClick:T,disabled:!!t(n).refresh_interval},[c(s,{name:"refresh"}),t(n).refresh_time>0?(i(),l("span",ke,$(t(n).refresh_time),1)):C("",!0)],8,He)]),t(n).users.length?(i(),l("div",Se,[(i(!0),l(U,null,Z(t(n).users,(M,b)=>(i(),l("div",{class:"friends-item",key:b},[e("div",Ne,[c(p,{user:M},null,8,["user"])]),e("div",we,[c(k,{price:M.referralBonusCoins,prefix:"+",round:!0},null,8,["price"])])]))),128))])):C("",!0),t(o)?(i(),l("div",Re,[c(S)])):C("",!0),!t(o)&&t(n).users.length===0?(i(),l("div",Ue,[t(_)?(i(),l("div",Ae,[e("div",Be,[c(s,{name:"robots"})]),Ve,Pe,Oe,Fe])):(i(),l("p",{key:1,innerHTML:a.$t("friends.no_friends")},null,8,ze))])):C("",!0)])}}}),Ge={class:"main"},je={class:"inner friends"},qe={class:"friends-button"},Ke={class:"friends-button-inner"},We=["disabled"],Ye=["innerHTML"],Je=["innerHTML"],Ze=["innerHTML"],Qe={class:"friends-invite"},Xe={class:"friends-invite-image"},xe=["src"],es={class:"friends-invite-info"},ss=["innerHTML"],ns={class:"friends-invite-info-item"},ts=["innerHTML"],os={class:"friends-invite-image"},rs=["src"],is={class:"friends-invite-info"},ls=["innerHTML"],as={class:"friends-invite-info-item"},cs=["innerHTML"],ds=["innerHTML"],us={class:"friends-bonuses"},_s=["innerHTML"],fs={class:"friends-bonuses-header"},ms=["innerHTML"],ps=["innerHTML"],hs=["innerHTML"],vs={class:"friends-bonuses-list"},ys=H({__name:"friends",setup(r){Y();const n=y(),u=ce();de();const o=I(!1),f=I(!1);let _=[];function d(){var s;y().trackEvent(W.CLICK_INVITE_FRIEND),R().useHapticFeedback("heavy"),(s=window==null?void 0:window.Telegram)==null||s.WebApp.openTelegramLink(L.value)}function g(){R().useHapticFeedback("heavy"),y().trackEvent(W.CLICK_COPY_INVITE_FRIEND)}J(()=>{try{_=Object.keys(m).filter(s=>!isNaN(Number(m[s]))&&m[s]!==m.Bronze).map(s=>({name:s,base:u.referralBonus.base.levelUp[m[s]],premium:u.referralBonus.premium.levelUp[m[s]]}))}catch(s){console.log(s)}});const T=N(()=>`${n.changeRandomCharToUppercase(w().$config.public.botUrl)}/${w().$config.public.miniAppUrl}?startapp=kentId${ue().account_id}`),a=N(()=>encodeURI(w().$i18n.t("share.link"))),L=N(()=>`https://t.me/share/url?text=${a.value}&url=${T.value}`);return(s,p)=>{var P,O,F,z,D,G;const k=A,S=Q,M=he,b=B,X=De,x=E("motion-slide-bottom"),ee=E("motion-slide-right"),se=E("motion-slide-left"),V=E("motion-pop");return i(),l("main",Ge,[e("div",je,[v((i(),l("div",qe,[e("div",Ke,[e("button",{class:"button button-primary button-default is-invite pulse",onClick:d,disabled:t(f)},[t(f)?(i(),_e(S,{key:1})):(i(),l(U,{key:0},[e("span",{innerHTML:s.$t("friends.invite_friend")},null,8,Ye),c(k,{class:"is-24",name:"friends"})],64))],8,We),c(M,{class:"is-copy button-primary button-default",text:t(T),onClick:g},null,8,["text"])])])),[[x]]),v(e("div",{class:"friends-title",innerHTML:s.$t("friends.title")},null,8,Je),[[ee]]),v(e("div",{class:"friends-description",innerHTML:s.$t("friends.description")},null,8,Ze),[[se]]),e("ul",Qe,[e("li",null,[e("div",Xe,[v(e("img",{class:"img-responsive",src:"IMAGE_INVITE"in s?s.IMAGE_INVITE:t(fe)},null,8,xe),[[V]])]),e("div",es,[e("div",{class:"friends-invite-info-title",innerHTML:s.$t("friends.invite_friend")},null,8,ss),e("div",ns,[c(b,{price:((F=(O=(P=t(u))==null?void 0:P.referralBonus)==null?void 0:O.base)==null?void 0:F.welcome)??2e3,prefix:"+",round:!1,color:"yellow"},null,8,["price"]),q("聽"),e("span",{innerHTML:s.$t("friends.for_you")},null,8,ts)])])]),e("li",null,[e("div",os,[v(e("img",{class:"img-responsive",src:"IMAGE_INVITE_PREMIUM"in s?s.IMAGE_INVITE_PREMIUM:t(me)},null,8,rs),[[V]])]),e("div",is,[e("div",{class:"friends-invite-info-title",innerHTML:s.$t("friends.invite_friend_premium")},null,8,ls),e("div",as,[c(b,{price:((G=(D=(z=t(u))==null?void 0:z.referralBonus)==null?void 0:D.premium)==null?void 0:G.welcome)??25e3,prefix:"+",round:!1,color:"yellow"},null,8,["price"]),q("聽"),e("span",{innerHTML:s.$t("friends.for_you")},null,8,cs)])])])]),v(e("div",{class:"friends-more-bonuses",onClick:p[0]||(p[0]=h=>o.value=!t(o))},[e("p",{innerHTML:s.$t("friends.more_bonuses")},null,8,ds)],512),[[K,!t(o)]]),v(e("div",us,[e("p",{innerHTML:s.$t("friends.bonus_title"),onClick:p[1]||(p[1]=h=>o.value=!t(o))},null,8,_s),e("div",fs,[e("span",{innerHTML:s.$t("user.level")},null,8,ms),e("span",{innerHTML:s.$t("friends.bonus_friend")},null,8,ps),e("span",{innerHTML:s.$t("friends.bonus_premium")},null,8,hs)]),e("ul",vs,[(i(!0),l(U,null,Z(t(_),(h,$s)=>(i(),l("li",{key:h.name},[e("div",null,[e("div",{class:"friends-bonuses-image",style:pe({"background-image":`url('/images/league/small/${h.name.toLowerCase()}.jpg')`})},null,4),e("p",null,$(h.name),1)]),e("div",null,[c(b,{price:h.base??0,prefix:"+",round:!1,color:"yellow"},null,8,["price"])]),e("div",null,[c(b,{price:h.premium??0,prefix:"+",round:!1,color:"yellow"},null,8,["price"])])]))),128))])],512),[[K,t(o)]]),c(X)])])}}});export{ys as default};
