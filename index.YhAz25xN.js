import{_ as J}from"./Hamster.vue.o-XLjD0K.js";import{_ as Q}from"./Preloader.vue.EL_BqhER.js";import{d as O,u as j,r as $,Z as H,o as u,a as m,e as t,b as e,w as N,a0 as ee,af as B,ag as F,a1 as se,n as te,m as P,a3 as ae,i as ne,$ as k,c as re,q as oe,k as f,a9 as V,C as b,F as I,D as w,t as U,l as le,a8 as ie,V as D,j as G}from"./entry.Dv1IsjD4.js";import{_ as ce}from"./image.vue.z4uqTG5J.js";import{_ as ue}from"./Price.vue.Cny252bW.js";import{N as de,E as me,a as _e,S as ge}from"./effect-fade.aa3pNKSS.js";const ve={class:"user-avatar"},fe=["srcset"],pe=["src"],he=O({__name:"AvatarImage",props:{image:{},compressed:{}},setup(_){const p=_;j();const a=$(p.image),r=$(p.compressed??"");a.value||(a.value=H);function h(){a.value=H}return(c,l)=>(u(),m("div",ve,[t("picture",null,[e(r)?(u(),m("source",{key:0,srcset:e(r),type:"image/webp"},null,8,fe)):N("",!0),t("img",{src:e(a),onError:l[0]||(l[0]=y=>h())},null,40,pe)])]))}}),ye=ee("league",{state:()=>({rating:[],tab:B.MINERS,period:F.DAY,currentLevel:0}),actions:{async postGetUsers(_){return await se.post("/clicker/rank",{body:{level:_}}).then(p=>{const{level:a,myRank:r,topUsers:h}=p;if(this.rating.find(l=>l.level===a)){const l=this.rating.findIndex(g=>g.level===a),y={level:a,myRank:r??null,topUsers:h??[]};this.rating[l]=y}else{const l={level:a,myRank:r??null,topUsers:h??[]};this.rating.push(l)}return p}).catch(p=>{te.error({title:P().$i18n.t("messages.request_error"),message:P().$i18n.t("messages.no_rank")})})},setTab(_=B.MINERS){this.tab=_},setPeriod(_=F.DAY){this.period=_},setCurrentLevel(_=1){this.currentLevel=_}},getters:{}}),Le={class:"main"},ke={class:"inner league"},$e={class:"league-item"},Se={class:"league-item-image"},Ue={class:"league-data"},Ce={class:"league-data-name"},be={class:"league-numbers"},Ne=["innerHTML"],Ae={class:"league-progress-outer"},Ee={key:0,class:"league-progress"},Ie={key:0,class:"league-users-progress"},xe={class:"league-user-avatar"},Te={class:"league-user-info"},Me={class:"league-user-info-top"},Re={class:"league-user-position"},He=["innerHTML"],Be={class:"league-user is-my",key:"myUser"},Fe={class:"league-user-avatar"},Pe={class:"league-user-info"},Ve={class:"league-user-info-top"},we={class:"league-user-position"},ze=O({__name:"index",setup(_){const p=[de,me],a=$(null),r=ye(),h=ae(),c=ne(),l=j(),y=$([]),g=$(""),A=$(!1),K=Object.values(k).filter(s=>!isNaN(s)),C=$(""),q=s=>g.value?g.value.includes("+")?!1:parseInt(g.value)===s:!1,z=re(()=>!!g.value&&g.value.includes("+")),W=()=>{var n;const s=(n=a.value)==null?void 0:n.slides;if(s){const d=s.find(i=>i.classList.contains("swiper-slide-fully-visible"));let v=null;if(d){const i=d.classList;for(let L=0;L<i.length;L++){const S=i[L];if(S.startsWith("is-")){v=S;break}}}if(C.value=v??"",v){const i=v.replace("is-","");T(i)!==r.currentLevel&&(r.setCurrentLevel(T(i)),x())}}},X=s=>{var n,d;a.value=s,C.value=`is-${E(k,((n=a==null?void 0:a.value)==null?void 0:n.activeIndex)+1)}`,r.setCurrentLevel(((d=a==null?void 0:a.value)==null?void 0:d.activeIndex)+1),x()},Y=s=>s>=c.getMaxUserLevel?`${G().t("friends.from")} ${l.numberFormat(c.getCoinsToLevelUpByLevel(s-1))}+`:c.level===s?`${l.numberFormat(c.balanceCoins??0)} / ${l.numberFormat(c.getCoinsToLevelUpByLevel(s)??0)}`:`${G().t("friends.from")} ${l.numberFormat(c.getCoinsToLevelUpByLevel(s-1))}`,x=async()=>{const s=r.rating.find(n=>n.level===r.currentLevel);s?(y.value=s.topUsers,g.value=s.myRank??""):(A.value=!0,await r.postGetUsers(r.currentLevel).then(n=>{y.value=n.topUsers,g.value=n.myRank??""}).finally(()=>{A.value=!1}))};function E(s,n){return Object.keys(s).find(d=>s[d]===n)}function T(s){const n=Object.keys(k).filter(i=>typeof k[i]=="number"),d=n.map(i=>k[i]),v=n.indexOf(s);if(v!==-1)return d[v]}return oe(()=>{r.rating=[]}),(s,n)=>{var M,R;const d=J,v=Q,i=he,L=ce,S=ue;return u(),m("main",Le,[t("div",ke,[f(e(ge),{class:b(["league-slider",e(C)]),loop:!1,effect:"fade",onSwiper:X,navigation:"",modules:p,onSlideChange:W,initialSlide:e(c).level-1},{default:V(()=>[(u(!0),m(I,null,w(e(K),o=>(u(),le(e(_e),{class:b(["league-slide",`is-${E(e(k),o)}`]),key:o},{default:V(()=>[t("div",$e,[t("div",Se,[f(d,{level:o},null,8,["level"])])]),t("div",Ue,[t("div",Ce,U(E(e(k),o)),1)]),t("div",be,[t("span",{innerHTML:Y(o)},null,8,Ne)]),t("div",Ae,[e(c).level===o?(u(),m("div",Ee,[t("div",{class:"league-progress-bar",style:ie({width:`${e(c).getProgressLevel}%`})},null,4)])):N("",!0)])]),_:2},1032,["class"]))),128))]),_:1},8,["initialSlide","class"]),t("div",{class:b(["league-users",e(C)])},[e(A)?(u(),m("div",Ie,[f(v)])):(u(),m(I,{key:1},[e(y).length>0?(u(!0),m(I,{key:0},w(e(y),(o,Z)=>(u(),m("div",{class:b(["league-user",{"is-my":q(o.rank)}]),key:`l${e(r).currentLevel}-${Z}`},[t("div",xe,[f(i,{image:o.avatarUrl??""},null,8,["image"])]),t("div",Te,[t("div",Me,[f(L,{name:o.exchangeId??e(D).DEFAULT_EXCHANGE},null,8,["name"]),t("p",null,U(e(l).composeUsername(o.firstName,o.lastName,o.username)),1)]),f(S,{price:o.earnPassivePerHour,round:!1},null,8,["price"])]),t("div",Re,U(o.rank),1)],2))),128)):e(y).length?N("",!0):(u(),m("p",{key:1,innerHTML:s.$t("league.no_users")},null,8,He)),e(z)?(u(),m("div",Be,[t("div",Fe,[f(i,{image:(M=e(h).account_avatar)==null?void 0:M.defaultUrl,compressed:(R=e(h).account_avatar)==null?void 0:R.compressedUrl},null,8,["image","compressed"])]),t("div",Pe,[t("div",Ve,[f(L,{name:e(c).exchangeId??e(D).DEFAULT_EXCHANGE},null,8,["name"]),t("p",null,U(e(h).account_name),1)]),f(S,{price:e(c).earnPassivePerHour??0,round:!1},null,8,["price"])]),t("div",we,U(e(g)),1)])):N("",!0)],64))],2)])])}}});export{ze as default};
